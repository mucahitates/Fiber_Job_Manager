<Window x:Class="FiberJobManager.Desktop.Views.CompletedJobsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Tamamlanan İşler" Height="600" Width="1200"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Başlık ve Toplam -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="Tamamlanan İşler" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
            <TextBlock Text="Toplam Tamamlanan: " FontSize="14" Margin="30,0,5,0" VerticalAlignment="Center"/>
            <TextBlock x:Name="TxtTotalCompleted" Text="0" FontSize="14" FontWeight="Bold" 
                       Foreground="Green" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- DataGrid -->
        <DataGrid Grid.Row="1" x:Name="CompletedJobsGrid"
                  AutoGenerateColumns="False"
                  IsReadOnly="False"
                  SelectionMode="Single"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  HeadersVisibility="Column"
                  GridLinesVisibility="Horizontal"
                  AlternatingRowBackground="#F5F5F5">

            <DataGrid.Columns>
                <!-- Proje Id -->
                <DataGridTextColumn Header="Proje Id" Binding="{Binding Id}" Width="80"/>

                <!-- Firma -->
                <DataGridTextColumn Header="Firma" Binding="{Binding Firma}" Width="120"/>

                <!-- Bölge -->
                <DataGridTextColumn Header="Bölge" Binding="{Binding Bolge}" Width="100"/>

                <!-- HK -->
                <DataGridTextColumn Header="HK" Binding="{Binding HK}" Width="100"/>

                <!-- SM -->
                <DataGridTextColumn Header="SM" Binding="{Binding SM}" Width="100"/>

                <!-- NVT -->
                <DataGridTextColumn Header="NVT" Binding="{Binding NVT}" Width="80"/>

                <!-- İlk Ölçüm -->
                <DataGridTextColumn Header="İlk Ölçüm" 
                                    Binding="{Binding FirstMeasurement, StringFormat='dd.MM.yyyy'}" 
                                    Width="100"/>

                <!-- Durum Göstergesi (Sadece Yeşil) -->
                <DataGridTemplateColumn Header="Durum" Width="80">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Ellipse Width="12" Height="12" 
                                         Fill="LimeGreen"
                                         Stroke="Gray" StrokeThickness="1"
                                         VerticalAlignment="Center">
                                    <Ellipse.ToolTip>
                                        <ToolTip Content="Tamamlandı"/>
                                    </Ellipse.ToolTip>
                                </Ellipse>
                                <TextBlock Text="Tamamlandı" 
                                           Margin="8,0,0,0" 
                                           FontSize="12"
                                           Foreground="Green"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <!-- Detay (Not Görüntüle) -->
                <DataGridTemplateColumn Header="Detay" Width="80">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="📝" 
                                    Width="30" Height="30"
                                    Click="BtnViewNote_Click"
                                    ToolTip="Notu Görüntüle"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Not Görüntüleme Popup -->
        <Popup x:Name="NotePopup" 
               Placement="Center"
               AllowsTransparency="True"
               StaysOpen="False">
            <Border Background="White" 
                    BorderBrush="Gray" 
                    BorderThickness="2" 
                    CornerRadius="5"
                    Padding="20"
                    Width="400">
                <StackPanel>
                    <TextBlock Text="Proje Notu" 
                               FontSize="16" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10"/>

                    <TextBox x:Name="TxtProjectNote" 
                             Height="120" 
                             TextWrapping="Wrap"
                             IsReadOnly="True"
                             VerticalScrollBarVisibility="Auto"
                             Margin="0,0,0,15"/>

                    <Button Content="Kapat" 
                            Width="100" 
                            Height="35"
                            Click="BtnCloseNote_Click"/>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Window>